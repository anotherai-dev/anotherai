---
title: Accessing Metrics and Data
summary: Create custom views and query your AI agent data using SQL to monitor performance, costs, and usage patterns
description: Build dashboards and analyze completion data through views and direct SQL queries
---

import { Tabs, Tab } from 'fumadocs-ui/components/tabs';
import { Steps, Step } from 'fumadocs-ui/components/steps';

One of the core features we wanted to unlock with AnotherAI was to allow users to access all their agent data in a way that would allow them to see the information that was important to *them*. 

For that reason we've enabled you to query your agent and organization-wide data both using the MCP and directly via REST API, and create custom views in the web app to visualize the retrieved data.

## What sorts of data can I query?

- Organization-wide data. This can include data about:
  - your overall spending across all agents
  - the most used agents
  - the agents that have the most failed completions

[IMAGE TODO: SCREENSHOT OF ORGANIZATION-WIDE DATA QUERY IN A VIEW]
- Agent-level data. This can include data about:
  - the cost of a specific agent
  - the latency of a specific agent
  - user feedback on a specific agent

[IMAGE TODO: SCREENSHOT OF AGENT-LEVEL DATA QUERY/OR COMPLETIONS LIST IN A VIEW]

## How do I create a view in AnotherAI?

The easiest way to create a view is to ask Claude Code to do it for you via the MCP by describing the data you want to see visualized.

For example: suppose you have an agent is becoming increasingly popular in your product. You want to keep an eye on the overall spend on that agent to ensure you don't go over budget. You also want to keep an eye on the speed of the models you're using, so that your customers aren't left with long wait times. You may ask Claude to create the following views as such:

<Steps>
<Step>
Describe the view or goal you want to Claude (or your preferred AI agent)

```
Create a view in AnotherAI that shows me the daily cost of anotherai/agent/calendar-event-extractor
```
[IMAGE TODO: SCREENSHOT OF VIEW CREATED FROM THIS PROMPT]
or 

```
Create a view in AnotherAI that shows me the total number of completions per day across all agents
```
[IMAGE TODO: SCREENSHOT OF VIEW CREATED FROM THIS PROMPT]
or 

```
Create a view in AnotherAI that shows all the completion outputs and annotations for anotherai/agent/calendar-event-extractor
```
[IMAGE TODO: SCREENSHOT OF VIEW CREATED FROM THIS PROMPT]
</Step>
<Step>
After creating a view, you can always make adjustments to it

```
Update anotherai/views/calendar-event-extractor-completions to include the completion inputs as well
```
[IMAGE TODO: SCREENSHOT OF VIEW UPDATED FROM THIS PROMPT]
</Step>
</Steps>


## Can I access this data outside of the web app?

Yes! If you want to integrate AnotherAI data into your existing business intelligence tools, you can also access the data via the `/v1/completions/query` endpoint. This provides the same functionality as the `query_completions` MCP tool but through HTTP requests, enabling you to further customize how you utilize the data available to you.

### Endpoint

```http
GET {{API_URL}}/v1/completions/query
```

### Authentication

Include your AnotherAI API key in the Authorization header:

```http
Authorization: Bearer aai-your-api-key
```

### Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `query` | string | Yes | SQL query to execute on the `completions` table |

### Response

Returns an array of objects representing the query results:

```json
[
  {
    "completion_id": "comp_123",
    "agent_id": "email-classifier",
    "model": "gpt-4o",
    "created_at": "2024-01-15T10:30:00Z",
    "total_tokens": 150,
    "cost_usd": 0.002
  }
]
```

### Example usage

<Tabs items={["cURL", "Python", "JavaScript"]}>
<Tab value="cURL">
```bash
curl -X GET "{{API_URL}}/v1/completions/query?query=SELECT%20*%20FROM%20completions%20WHERE%20agent_id%20%3D%20%27email-classifier%27%20LIMIT%2010" \
  -H "Authorization: Bearer aai-your-api-key" \
  -H "Content-Type: application/json"
```
</Tab>
<Tab value="Python">
```python
import requests

url = "{{API_URL}}/v1/completions/query"
headers = {
    "Authorization": "Bearer aai-your-api-key",
    "Content-Type": "application/json"
}
params = {
    "query": "SELECT * FROM completions WHERE agent_id = 'email-classifier' LIMIT 10"
}

response = requests.get(url, headers=headers, params=params)
data = response.json()
```
</Tab>
<Tab value="JavaScript">
```javascript
const url = new URL("{{API_URL}}/v1/completions/query");
url.searchParams.append("query", "SELECT * FROM completions WHERE agent_id = 'email-classifier' LIMIT 10");

const response = await fetch(url, {
    headers: {
        "Authorization": "Bearer aai-your-api-key",
        "Content-Type": "application/json"
    }
});

const data = await response.json();
```
</Tab>
</Tabs>

### Common queries

Here are some useful SQL queries for analyzing your completion data:

```sql
-- Get completions for a specific agent in the last 24 hours
SELECT * FROM completions 
WHERE agent_id = 'my-agent' 
AND created_at >= NOW() - INTERVAL 1 DAY
ORDER BY created_at DESC;

-- Analyze cost and token usage by model
SELECT model, COUNT(*) as completion_count, 
       SUM(total_tokens) as total_tokens, 
       SUM(cost_usd) as total_cost
FROM completions 
GROUP BY model
ORDER BY total_cost DESC;

-- Find slow completions (over 5 seconds)
SELECT completion_id, agent_id, model, duration_ms
FROM completions 
WHERE duration_ms > 5000
ORDER BY duration_ms DESC;
```
